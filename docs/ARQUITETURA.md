# ğŸ—ï¸ Arquitetura do WineBrain

## VisÃ£o Geral do Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAMADA DE APRESENTAÃ‡ÃƒO                     â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Interface Web (React + Vite)                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ Dashboard Executivo    â€¢ Lista de Clientes            â”‚  â”‚
â”‚  â”‚  â€¢ GrÃ¡ficos Interativos   â€¢ Detalhes + RecomendaÃ§Ãµes     â”‚  â”‚
â”‚  â”‚  â€¢ Busca e Filtros        â€¢ VisualizaÃ§Ãµes (Recharts)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†• HTTP/REST                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAMADA DE API                              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  API REST (FastAPI)                       â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Endpoints:                                               â”‚  â”‚
â”‚  â”‚  â€¢ /api/dashboard/stats        â€¢ /api/clientes           â”‚  â”‚
â”‚  â”‚  â€¢ /api/clientes/{id}          â€¢ /api/clientes/{id}/rec  â”‚  â”‚
â”‚  â”‚  â€¢ /api/dashboard/top-*        â€¢ /api/analytics/segm     â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Componentes:                                             â”‚  â”‚
â”‚  â”‚  â€¢ ValidaÃ§Ã£o (Pydantic)    â€¢ CORS                        â”‚  â”‚
â”‚  â”‚  â€¢ Rotas                   â€¢ DocumentaÃ§Ã£o (Swagger)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMADA DE INTELIGÃŠNCIA                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ML ENGINE        â”‚              â”‚   RULE ENGINE       â”‚   â”‚
â”‚  â”‚                    â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚ â€¢ Random Forest    â”‚    â†â”€â”€â”€â”€â†’    â”‚ â€¢ 6 Regras         â”‚   â”‚
â”‚  â”‚ â€¢ Decision Tree    â”‚              â”‚ â€¢ PriorizaÃ§Ã£o      â”‚   â”‚
â”‚  â”‚ â€¢ Logistic Reg     â”‚              â”‚ â€¢ InferÃªncia       â”‚   â”‚
â”‚  â”‚                    â”‚              â”‚ â€¢ SegmentaÃ§Ã£o      â”‚   â”‚
â”‚  â”‚ Features:          â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚  - engajamento     â”‚              â”‚ Outputs:           â”‚   â”‚
â”‚  â”‚  - total_gasto     â”‚              â”‚  - AÃ§Ãµes           â”‚   â”‚
â”‚  â”‚  - n_compras       â”‚              â”‚  - Prioridade      â”‚   â”‚
â”‚  â”‚  - idade           â”‚              â”‚  - Mensagem        â”‚   â”‚
â”‚  â”‚  - clube           â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚  - cidade          â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚                    â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚ Output:            â”‚              â”‚                     â”‚   â”‚
â”‚  â”‚  prob_churn: 0-1   â”‚              â”‚                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAMADA DE DADOS                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Data Processing                         â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ Pandas (manipulaÃ§Ã£o)      â€¢ NumPy (cÃ¡lculos)          â”‚  â”‚
â”‚  â”‚  â€¢ Openpyxl (Excel â†’ CSV)    â€¢ AgregaÃ§Ãµes                â”‚  â”‚
â”‚  â”‚  â€¢ Feature Engineering       â€¢ Encoding                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†•                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Armazenamento                          â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Raw Data:               Processed:          Models:      â”‚  â”‚
â”‚  â”‚  â€¢ clientes.csv          â€¢ agregado.csv      â€¢ .pkl       â”‚  â”‚
â”‚  â”‚  â€¢ produtos.csv          â€¢ completo.csv      â€¢ trained    â”‚  â”‚
â”‚  â”‚  â€¢ compras.csv           â€¢ summary.json      â€¢ metadata   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de Dados Principal

### 1. PrediÃ§Ã£o de Churn + RecomendaÃ§Ãµes

```
[UsuÃ¡rio clica em Cliente X]
         â†“
[Frontend faz request: GET /api/clientes/{id}/recomendacao]
         â†“
[API busca dados do cliente no CSV/DB]
         â†“
[ML Engine: extrai features e prediz probabilidade de churn]
         â†“
[Rule Engine: aplica 6 regras baseado em dados + probabilidade]
         â†“
[Consolida recomendaÃ§Ãµes com prioridade]
         â†“
[API retorna JSON com anÃ¡lise completa]
         â†“
[Frontend renderiza cards com aÃ§Ãµes sugeridas]
```

### 2. Dashboard

```
[UsuÃ¡rio acessa Dashboard]
         â†“
[Frontend faz mÃºltiplos requests paralelos:]
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                â†“              â†“               â†“
[/stats]    [/top-clientes]  [/vendas-uva]  [/segmentacao]
    â†“                â†“              â†“               â†“
[API agrega dados e retorna mÃ©tricas]
    â†“                â†“              â†“               â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
[Frontend renderiza KPIs, grÃ¡ficos e tabelas]
```

---

## ğŸ§© Componentes Detalhados

### Backend (Python)

```
backend/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ main.py                    # AplicaÃ§Ã£o FastAPI principal
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ churn_model.py             # Classe ChurnPredictor
â”‚   â”‚   â”œâ”€â”€ prepare_features()     # PreparaÃ§Ã£o de dados
â”‚   â”‚   â”œâ”€â”€ train()                # Treinamento
â”‚   â”‚   â”œâ”€â”€ predict()              # PrediÃ§Ã£o binÃ¡ria
â”‚   â”‚   â”œâ”€â”€ predict_proba()        # Probabilidade
â”‚   â”‚   â”œâ”€â”€ save_model()           # PersistÃªncia
â”‚   â”‚   â””â”€â”€ load_model()           # Carregamento
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ knowledge_base/
â”‚   â”œâ”€â”€ rules.py                   # Motor de Regras
â”‚   â”‚   â”œâ”€â”€ RuleEngine             # Classe principal
â”‚   â”‚   â”‚   â”œâ”€â”€ avaliar_cliente()  # AvaliaÃ§Ã£o completa
â”‚   â”‚   â”‚   â”œâ”€â”€ _regra_1()        # Cliente Premium
â”‚   â”‚   â”‚   â”œâ”€â”€ _regra_2()        # Risco Cancelamento
â”‚   â”‚   â”‚   â”œâ”€â”€ _regra_3()        # Oportunidade Upgrade
â”‚   â”‚   â”‚   â”œâ”€â”€ _regra_4()        # ConversÃ£o Clube
â”‚   â”‚   â”‚   â”œâ”€â”€ _regra_5()        # Alto Risco Churn
â”‚   â”‚   â”‚   â””â”€â”€ _regra_6()        # Cliente Inativo
â”‚   â”‚   â”œâ”€â”€ AcaoRecomendada        # Enum de aÃ§Ãµes
â”‚   â”‚   â””â”€â”€ NivelPrioridade        # Enum de prioridades
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ load_data.py                   # Processamento de dados
â”‚   â”œâ”€â”€ load_excel_data()          # Carrega .xlsx
â”‚   â”œâ”€â”€ save_to_csv()              # Converte para CSV
â”‚   â”œâ”€â”€ analyze_data()             # AnÃ¡lise exploratÃ³ria
â”‚   â””â”€â”€ generate_summary_json()    # Resumo estatÃ­stico
â”‚
â”œâ”€â”€ run.py                         # InicializaÃ§Ã£o do servidor
â”œâ”€â”€ requirements.txt               # DependÃªncias Python
â””â”€â”€ .env.example                   # ConfiguraÃ§Ãµes
```

### Frontend (React)

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx          # Dashboard executivo
â”‚   â”‚   â”‚   â”œâ”€â”€ KPI Cards
â”‚   â”‚   â”‚   â”œâ”€â”€ Charts (Recharts)
â”‚   â”‚   â”‚   â””â”€â”€ Tables
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Clientes.jsx           # Lista de clientes
â”‚   â”‚   â”‚   â”œâ”€â”€ Search bar
â”‚   â”‚   â”‚   â”œâ”€â”€ Filtros
â”‚   â”‚   â”‚   â””â”€â”€ Tabela com badges
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ClienteDetalhes.jsx    # Perfil + IA
â”‚   â”‚       â”œâ”€â”€ Header (perfil)
â”‚   â”‚       â”œâ”€â”€ MÃ©tricas (cards)
â”‚   â”‚       â”œâ”€â”€ AnÃ¡lise de risco
â”‚   â”‚       â””â”€â”€ RecomendaÃ§Ãµes
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ api.js                 # IntegraÃ§Ã£o com backend
â”‚   â”‚       â”œâ”€â”€ getDashboardStats()
â”‚   â”‚       â”œâ”€â”€ getClientes()
â”‚   â”‚       â”œâ”€â”€ getCliente()
â”‚   â”‚       â”œâ”€â”€ getRecomendacao()
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ App.jsx                    # App principal + Router
â”‚   â”œâ”€â”€ main.jsx                   # Entry point
â”‚   â””â”€â”€ index.css                  # Estilos globais
â”‚
â”œâ”€â”€ index.html                     # HTML base
â”œâ”€â”€ vite.config.js                 # Config Vite
â”œâ”€â”€ tailwind.config.js             # Config Tailwind
â””â”€â”€ package.json                   # DependÃªncias Node
```

---

## ğŸ” SeguranÃ§a e ValidaÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Request do Frontend            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CORS Middleware                 â”‚
â”‚  â€¢ ValidaÃ§Ã£o de origem                  â”‚
â”‚  â€¢ Headers permitidos                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ValidaÃ§Ã£o Pydantic                 â”‚
â”‚  â€¢ Tipos de dados                       â”‚
â”‚  â€¢ Campos obrigatÃ³rios                  â”‚
â”‚  â€¢ Ranges vÃ¡lidos                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       LÃ³gica de NegÃ³cio                 â”‚
â”‚  â€¢ Processamento                        â”‚
â”‚  â€¢ ML / Regras                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Response Estruturado               â”‚
â”‚  â€¢ JSON Schema                          â”‚
â”‚  â€¢ CÃ³digos HTTP corretos                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Pipeline de Machine Learning

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         1. COLETA DE DADOS              â”‚
â”‚  â€¢ Cliente.xlsx                         â”‚
â”‚  â€¢ produtos.xlsx                        â”‚
â”‚  â€¢ Compras.xlsx                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      2. PROCESSAMENTO                   â”‚
â”‚  â€¢ ConversÃ£o Excel â†’ CSV                â”‚
â”‚  â€¢ Merge de tabelas                     â”‚
â”‚  â€¢ AgregaÃ§Ã£o por cliente                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    3. FEATURE ENGINEERING               â”‚
â”‚  â€¢ total_gasto = sum(valor)             â”‚
â”‚  â€¢ n_compras = count(compras)           â”‚
â”‚  â€¢ ticket_medio = total/n_compras       â”‚
â”‚  â€¢ Label encoding (cidade)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      4. DIVISÃƒO DOS DADOS               â”‚
â”‚  â€¢ Train: 80%                           â”‚
â”‚  â€¢ Test: 20%                            â”‚
â”‚  â€¢ Stratify: cancelou_assinatura        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       5. TREINAMENTO                    â”‚
â”‚  â€¢ Random Forest (100 trees)            â”‚
â”‚  â€¢ Decision Tree (depth 5)              â”‚
â”‚  â€¢ Logistic Regression                  â”‚
â”‚  â€¢ class_weight='balanced'              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       6. AVALIAÃ‡ÃƒO                      â”‚
â”‚  â€¢ AcurÃ¡cia                             â”‚
â”‚  â€¢ PrecisÃ£o                             â”‚
â”‚  â€¢ Recall                               â”‚
â”‚  â€¢ F1-Score                             â”‚
â”‚  â€¢ Feature Importance                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     7. SELEÃ‡ÃƒO DO MELHOR               â”‚
â”‚  â€¢ ComparaÃ§Ã£o de mÃ©tricas               â”‚
â”‚  â€¢ Random Forest (melhor F1)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      8. PERSISTÃŠNCIA                    â”‚
â”‚  â€¢ Salvar modelo (.pkl)                 â”‚
â”‚  â€¢ Salvar encoders                      â”‚
â”‚  â€¢ Salvar feature names                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       9. PREDIÃ‡ÃƒO EM PRODUÃ‡ÃƒO           â”‚
â”‚  â€¢ Carregar modelo                      â”‚
â”‚  â€¢ Predizer para novos clientes         â”‚
â”‚  â€¢ Retornar probabilidade               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  IntegraÃ§Ã£o ML + Regras

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ENTRADA: Dados do Cliente                     â”‚
â”‚                                                                  â”‚
â”‚  {                                                               â”‚
â”‚    cliente_id: 1,                                               â”‚
â”‚    pontuacao_engajamento: 3.2,                                  â”‚
â”‚    assinante_clube: False,                                      â”‚
â”‚    total_gasto: 120.00,                                         â”‚
â”‚    n_compras: 2,                                                â”‚
â”‚    ...                                                          â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       MODELO DE ML                      â”‚
â”‚                                         â”‚
â”‚  Input: [3.2, 120.00, 2, ...]          â”‚
â”‚  Processing: Random Forest              â”‚
â”‚  Output: prob_churn = 0.75 (75%)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       MOTOR DE REGRAS                   â”‚
â”‚                                         â”‚
â”‚  Avalia 6 regras:                       â”‚
â”‚  âœ… REGRA 2: Risco (eng < 4)           â”‚
â”‚  âœ… REGRA 5: Churn alto (0.75 > 0.7)   â”‚
â”‚  âœ… REGRA 6: Inativo (n_compras â‰¤ 2)   â”‚
â”‚                                         â”‚
â”‚  Prioriza: CRÃTICA                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SAÃDA: RecomendaÃ§Ãµes                         â”‚
â”‚                                                                  â”‚
â”‚  {                                                               â”‚
â”‚    segmento: "Em Risco",                                        â”‚
â”‚    probabilidade_churn: 0.75,                                   â”‚
â”‚    prioridade: "critica",                                       â”‚
â”‚    acoes_recomendadas: [                                        â”‚
â”‚      {                                                          â”‚
â”‚        regra: "REGRA_2_RISCO_CANCELAMENTO",                    â”‚
â”‚        acao: "enviar_cupom_reativacao",                        â”‚
â”‚        descricao: "Enviar cupom de 20% OFF",                   â”‚
â”‚        prioridade: "critica"                                    â”‚
â”‚      },                                                         â”‚
â”‚      {                                                          â”‚
â”‚        regra: "REGRA_5_ALTO_RISCO_CHURN",                      â”‚
â”‚        acao: "campanha_reengajamento",                         â”‚
â”‚        descricao: "Ativar campanha urgente",                   â”‚
â”‚        prioridade: "critica"                                    â”‚
â”‚      }                                                          â”‚
â”‚    ],                                                           â”‚
â”‚    mensagem: "âš ï¸ Cliente em risco! 2 aÃ§Ãµes urgentes."          â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ DecisÃµes Arquiteturais

### Por que FastAPI?
âœ… Performance (async/await)
âœ… DocumentaÃ§Ã£o automÃ¡tica (Swagger)
âœ… ValidaÃ§Ã£o de tipos (Pydantic)
âœ… Moderna e pythÃ´nica

### Por que React + Vite?
âœ… Build rÃ¡pido
âœ… Hot Module Replacement
âœ… ComponentizaÃ§Ã£o
âœ… Ecossistema rico

### Por que Random Forest?
âœ… Boa performance com dados tabulares
âœ… Resistente a overfitting
âœ… Feature importance interpretÃ¡vel
âœ… NÃ£o requer normalizaÃ§Ã£o

### Por que Regras + ML?
âœ… ML captura padrÃµes complexos
âœ… Regras trazem conhecimento do negÃ³cio
âœ… CombinaÃ§Ã£o oferece explicabilidade
âœ… Permite ajustes finos por especialistas

---

**Arquitetura versÃ£o**: 1.0.0
**Ãšltima atualizaÃ§Ã£o**: Novembro 2025
